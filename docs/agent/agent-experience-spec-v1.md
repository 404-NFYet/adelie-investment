# Agent Experience Spec v1

## 목적
- 사용자가 현재 보고 있는 화면을 기준으로 에이전트가 설명/이동/조작을 이어주는 경험을 정의한다.
- 채팅 버블 중심 UX가 아니라 화면 중심 캔버스 + 인라인 제어 트레이를 기본으로 한다.

## IA
- 하단 탭: `투자(/portfolio) - 홈(/home) - 교육(/education)`
- 프로필: 상단 아이콘으로 `/profile` 진입
- 에이전트 상세: `/agent`
- 에이전트 기록: `/agent/history`

## 핵심 컴포넌트
- `AgentDock`: 전역 하단 입력바
- `AgentInlineControlTray`: 인라인 제어 쇼(상황 요약 + 액션칩 + 상태)
- `AgentControlPulse`: 에이전트 통제권 활성 상태 애니메이션
- `AgentCanvasPage`: 상세 분석/설명 화면

## 사용자 체감 흐름
1. 사용자는 홈/투자/교육 화면을 본다.
2. 하단 트레이가 현재 컨텍스트 기준 추천 액션을 보여준다.
3. 저위험 명령은 캔버스 없이 즉시 실행된다.
4. 분석형 질의는 `/agent`로 전환되어 캔버스 답변을 본다.
5. 같은 세션의 이전 답변은 길게 스와이프로 탐색한다.

## 캔버스 표시 원칙
- 일반 응답: 텍스트 블록만 표시
- 구조화 응답(불릿/헤더 신호): key/bullet 섹션 확장 표시
- 상단은 항상 다음 2줄로 고정
  - 컨텍스트: `AI가 보고 있는 것 · ...`
  - 상태: 점 애니메이션 + 실행 텍스트(필요 시 모델명)
- 3단계 진행바는 `home` 모드에서만 노출

## 스와이프 탐색 원칙
- 임계값: `160px`
- 짧은 스와이프: 이동하지 않고 힌트 토스트만 표시
- 긴 스와이프:
  - 위로: 이전 답변
  - 아래로: 다음 답변
- UI 넛지:
  - 상단 핸들 형태
  - `n/m` 페이저
  - 드래그 진행률 바

## 제어 상태 시각화
- `idle`: 회색 상태
- `running`: 주황 글로우 + `Agent control active`
- `success`: 초록 상태
- `error`: 빨강 상태

## 비기능 요구사항
- 파이프라인/DB/인프라 스키마 변경 없음
- 기존 `/api/v1/tutor/chat` 재사용
- 프론트는 `context_text` 확장 스키마를 사용하되, 서버가 모르는 필드는 무시 가능해야 함
