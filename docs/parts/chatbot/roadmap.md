# Chatbot 개선 로드맵

## P0 — 즉시 개선 (필수)

### 안정성
- [ ] SSE 스트리밍 에러 핸들링 — OpenAI API 타임아웃, 연결 끊김 시 graceful 복구
- [ ] 세션 관리 강화 — 장시간 미사용 세션 정리, 세션 상한 설정
- [ ] 토큰 사용량 모니터링 — 대화당/세션당 토큰 소비 추적 및 제한
- [ ] 응답 품질 검증 — 할루시네이션 탐지 로직 추가 (용어 설명 정확성)

### 프롬프트 개선
- [ ] 난이도별 프롬프트 정교화 — beginner/elementary/intermediate 각각의 톤/깊이 차별화
- [ ] 컨텍스트 주입 최적화 — 현재 페이지 데이터를 효율적으로 프롬프트에 포함
- [ ] 한글 자연스러움 — 번역체 제거, 구어체/문어체 일관성
- [ ] 프롬프트 버전 관리 — 변경 이력 추적, A/B 테스트 기반 선택

## P1 — 중기 개선 (기능)

### 도구 확장
- [ ] 실시간 주가 도구 — 현재가/등락률 실시간 조회 (pykrx 또는 외부 API)
- [ ] 뉴스 요약 도구 — 최신 뉴스 크롤링 후 요약 (Perplexity 활용)
- [ ] 포트폴리오 분석 도구 — 사용자 보유 종목 기반 맞춤 분석
- [ ] 퀴즈 생성 도구 — 학습 내용 기반 자동 퀴즈 출제

### 이력 영속화
- [ ] LangGraph 체크포인터 프로덕션 적용 — 실험 코드를 프로덕션으로 전환
- [ ] 대화 이력 검색 — 과거 대화에서 키워드 검색
- [ ] 대화 요약 — 장기 세션의 대화 요약 생성 (컨텍스트 윈도우 절약)
- [ ] 대화 내보내기 — 학습 내용 정리본 PDF/마크다운 다운로드

### LangSmith 모니터링
- [ ] 프로덕션 트레이싱 — 모든 튜터 응답에 LangSmith 트레이스 연결
- [ ] 피드백 수집 — 사용자 좋아요/싫어요 → LangSmith 피드백 연동
- [ ] 비용 대시보드 — 일별/모델별 API 비용 추적

## P2 — 장기 개선 (확장)

### 모델 전환
- [ ] Claude 모델 옵션 — OpenAI 외에 Claude 모델 선택 가능 (CLAUDE_API_KEY 활용)
- [ ] 모델 라우팅 — 질문 복잡도에 따라 gpt-4o-mini / gpt-4o / Claude 자동 선택
- [ ] 로컬 모델 폴백 — API 장애 시 경량 로컬 모델로 기본 응답 (추후 검토)

### 컨텍스트 고도화
- [ ] RAG 파이프라인 — 내러티브/리서치 데이터를 벡터 DB에 저장, 검색 증강 생성
- [ ] 사용자 프로필 반영 — 투자 경험, 관심 종목, 학습 이력 기반 개인화
- [ ] 멀티턴 전략 — 대화 흐름에 따른 능동적 질문/가이드 (스캐폴딩)
- [ ] 멀티모달 — 차트 이미지 입력 분석 (GPT-4 Vision 활용)

### 에이전트 전환
- [ ] LangGraph 에이전트 프로덕션 전환 — `tutor_agent.py`를 프로덕션 엔진으로 교체
- [ ] 멀티 에이전트 — 역할별 에이전트 분리 (설명/분석/퀴즈)
- [ ] Human-in-the-loop — 전문가 검수가 필요한 응답 플래그
